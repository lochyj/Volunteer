<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create new event | Volunteer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            font-family: 'Roboto', sans-serif;
        }

        body {
            background-color: #f5f5f5;
        }

        .content {
            width: 400px;
            margin: 0 auto;
            margin-top: 50px;
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
        }
        
        .content h1 {
            text-align: center;
            margin-bottom: 20px;
        }

        .form {
            margin-bottom: 20px;
        }
        
        .form input {
            width: 94%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 3px;
        }

        .form textarea {
            width: 94%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 3px;
            font-size: 0.9em;
        }
        
        .form button {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin: 3px;
            background-color: #00684A;
            color: #fff;
            font-size: 16px;
        }
        .important {
            color: red;
        }
        .tag {
            background-color: #ccc;
            border-radius: 25px;
            padding: 5px;
            margin: 5px;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div>
        <div class="content">
            <h1>Create new event</h1>
            <div id="form" class="form">
                <input type="text" id="name" placeholder="Title"><br>

                <textarea id="description" placeholder="Description"></textarea><br>

                <label for="date_from">Date from</label><br>
                <input type="date" id="date_from"><br>

                <label for="date_to">Date to</label><br>
                <input type="date" id="date_to"><br>

                <label for="time_from">Time from</label><br>
                <input type="time" id="time_from"><br>

                <label for="time_to">Time to</label><br>
                <input type="time" id="time_to"><br>

                <input type="text" id="location" placeholder="Location"><br><br>

                <span for="type">
                    Examples:
                        <span class="tag">sport</span>
                        <span class="tag">fundraising</span>
                </span><br>
                <input type="text" name="type" id="type" placeholder="Tags"><br>

                <button id="submit">Submit</button><br>

                <span id="warn" class="important"></span>

            </div>
        </div>
    <script>
        const form = document.getElementById("form");

        const warn = document.getElementById("warn");

        const submit = document.getElementById("submit");

        // TODO: get map api working for location selection

        submit.addEventListener("click", (e) => {
            e.preventDefault();

            const name = document.getElementById("name").value;
            const description = document.getElementById("description").value;
            const date_from = document.getElementById("date_from").value;
            const date_to = document.getElementById("date_to").value;
            const time_from = document.getElementById("time_from").value;
            const time_to = document.getElementById("time_to").value;
            const location = document.getElementById("location").value;
            const type = document.getElementById("type").value;

            if (!name || !description || !date_from || !date_to || !time_from || !time_to || !location || !type) {
                warn.innerText = "Please fill in all fields.";
                return;
            }

            const data = {
                title: name,
                description: description,
                location: location,
                date: [date_from, date_to],
                time: [time_from, time_to],
                tags: type
            };

            fetch("/api/event/create", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(data)
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    alert("Event created successfully!");
                    window.location.href = "/event/" + data.event_id;
                } else {
                    alert("Error: " + data.message);
                }
            })
            .catch(err => {
                console.log(err);
                alert("Error: " + err);
            });
        });

    </script>
</body>
</html>